#!/bin/bash

usage() {
    echo "Usage: run-tests [-V]"
    echo "  -V: verbose test output"
}

option_given=0

OUTPUT_DIR="$HOME/Documents/VS_Code/course-companion/tests/output_logs"

while getopts ":V" opt; do
    option_given=1
    case $opt in
        V)
            ctest --verbose
            ;;
        \?)
            echo "Invalid option: -$opt" >&2
            usage
            exit 1
            ;;
    esac
done

if [ $option_given -eq 0 ]; then
    ctest --output-on-failure
fi

mkdir -p "$OUTPUT_DIR"

if [ -f Testing/Temporary/LastTest.log ]; then
    cp Testing/Temporary/LastTest.log "$OUTPUT_DIR/"
else
    echo "Warning: LastTest.log not found"
fi
